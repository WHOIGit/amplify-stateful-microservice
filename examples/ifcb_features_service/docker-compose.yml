version: '3.8'

services:
  features:
    build:
      context: ../..
      dockerfile: examples/ifcb_features_service/Dockerfile
    ports:
      - "8002:8000"
    env_file:
      - .env
    environment:
      - S3_ENDPOINT_URL=${S3_ENDPOINT_URL:-http://localhost:9000}
      - S3_ACCESS_KEY=${S3_ACCESS_KEY}
      - S3_SECRET_KEY=${S3_SECRET_KEY}
      - S3_BUCKET=${S3_BUCKET:-ifcb-features}
      - S3_DATASETS_PREFIX=${S3_DATASETS_PREFIX:-datasets}
      - S3_RESULTS_PREFIX=${S3_RESULTS_PREFIX:-results}
      - MAX_CONCURRENT_JOBS=${MAX_CONCURRENT_JOBS:-4}
    restart: unless-stopped
